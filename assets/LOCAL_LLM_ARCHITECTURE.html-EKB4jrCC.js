import{_ as t,r as p,o as l,c as o,a as n,b as a,d as e,e as i}from"./app-Zho5QKIq.js";const c={},r=i(`<h1 id="ğŸ¤–-æœ¬åœ°å¤§æ¨¡å‹é›†æˆç³»ç»Ÿæ¶æ„" tabindex="-1"><a class="header-anchor" href="#ğŸ¤–-æœ¬åœ°å¤§æ¨¡å‹é›†æˆç³»ç»Ÿæ¶æ„" aria-hidden="true">#</a> ğŸ¤– æœ¬åœ°å¤§æ¨¡å‹é›†æˆç³»ç»Ÿæ¶æ„</h1><blockquote><p>åŸºäº Mac M2 èŠ¯ç‰‡çš„æœ¬åœ°å¤§æ¨¡å‹éƒ¨ç½²ä¸ Claude Tools é›†æˆæ–¹æ¡ˆ</p></blockquote><h2 id="ğŸ“–-æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#ğŸ“–-æ¦‚è¿°" aria-hidden="true">#</a> ğŸ“– æ¦‚è¿°</h2><p>è¿™æ˜¯ä¸€ä¸ªåˆ›æ–°çš„AIå·¥å…·é“¾æ¶æ„ï¼Œå°† Claude Code çš„å¼ºå¤§å·¥å…·èƒ½åŠ›ä¸æœ¬åœ°éƒ¨ç½²çš„å¤§æ¨¡å‹ç›¸ç»“åˆï¼Œå®ç°æˆæœ¬æ•ˆç›Šæœ€å¤§åŒ–ã€éšç§ä¿æŠ¤å’Œæ€§èƒ½ä¼˜åŒ–çš„å®Œç¾å¹³è¡¡ã€‚</p><h2 id="ğŸ—ï¸-ç³»ç»Ÿæ¶æ„å›¾" tabindex="-1"><a class="header-anchor" href="#ğŸ—ï¸-ç³»ç»Ÿæ¶æ„å›¾" aria-hidden="true">#</a> ğŸ—ï¸ ç³»ç»Ÿæ¶æ„å›¾</h2><div class="language-mermaid line-numbers-mode" data-ext="mermaid"><pre class="language-mermaid"><code><span class="token keyword">graph</span> TB
    <span class="token keyword">subgraph</span> <span class="token string">&quot;ç”¨æˆ·äº¤äº’å±‚&quot;</span>
        A<span class="token text string">[Claude Code CLI]</span> <span class="token arrow operator">--&gt;</span> B<span class="token text string">[ä»»åŠ¡åˆ†æå™¨]</span>
    <span class="token keyword">end</span>

    <span class="token keyword">subgraph</span> <span class="token string">&quot;è·¯ç”±å†³ç­–å±‚&quot;</span>
        B <span class="token arrow operator">--&gt;</span> C<span class="token text string">{æ™ºèƒ½è·¯ç”±å™¨}</span>
        C <span class="token arrow operator">--&gt;</span><span class="token label property">|å¤æ‚æ¨ç†|</span> D<span class="token text string">[Claude API]</span>
        C <span class="token arrow operator">--&gt;</span><span class="token label property">|æœ¬åœ°å¤„ç†|</span> E<span class="token text string">[æœ¬åœ°å¤§æ¨¡å‹è°ƒç”¨]</span>
    <span class="token keyword">end</span>

    <span class="token keyword">subgraph</span> <span class="token string">&quot;æœ¬åœ°æœåŠ¡å±‚&quot;</span>
        E <span class="token arrow operator">--&gt;</span> F<span class="token text string">[è½¬å‘ä»£ç†æœåŠ¡&lt;br/&gt;FastAPI :8000]</span>
        F <span class="token arrow operator">--&gt;</span> G<span class="token text string">[Ollama æœåŠ¡&lt;br/&gt;:11434]</span>
    <span class="token keyword">end</span>

    <span class="token keyword">subgraph</span> <span class="token string">&quot;æ¨¡å‹å±‚&quot;</span>
        G <span class="token arrow operator">--&gt;</span> H<span class="token text string">[Llama 3.1 8B&lt;br/&gt;é€šç”¨ä»»åŠ¡]</span>
        G <span class="token arrow operator">--&gt;</span> I<span class="token text string">[Qwen 2.5 7B&lt;br/&gt;ä¸­æ–‡ä¼˜åŒ–]</span>
        G <span class="token arrow operator">--&gt;</span> J<span class="token text string">[DeepSeek Coder 6.7B&lt;br/&gt;ä»£ç ä»»åŠ¡]</span>
    <span class="token keyword">end</span>

    <span class="token keyword">subgraph</span> <span class="token string">&quot;åŸºç¡€è®¾æ–½&quot;</span>
        K<span class="token text string">[Mac M2 èŠ¯ç‰‡&lt;br/&gt;ç»Ÿä¸€å†…å­˜æ¶æ„]</span> <span class="token arrow operator">--&gt;</span> L<span class="token text string">[Metal GPU åŠ é€Ÿ]</span>
        L <span class="token arrow operator">--&gt;</span> G
    <span class="token keyword">end</span>

    <span class="token keyword">style</span> A <span class="token style"><span class="token property">fill</span><span class="token operator">:</span>#e1f5fe</span>
    <span class="token keyword">style</span> C <span class="token style"><span class="token property">fill</span><span class="token operator">:</span>#f3e5f5</span>
    <span class="token keyword">style</span> F <span class="token style"><span class="token property">fill</span><span class="token operator">:</span>#e8f5e8</span>
    <span class="token keyword">style</span> G <span class="token style"><span class="token property">fill</span><span class="token operator">:</span>#fff3e0</span>
    <span class="token keyword">style</span> K <span class="token style"><span class="token property">fill</span><span class="token operator">:</span>#fce4ec</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ¯-æ ¸å¿ƒä¼˜åŠ¿" tabindex="-1"><a class="header-anchor" href="#ğŸ¯-æ ¸å¿ƒä¼˜åŠ¿" aria-hidden="true">#</a> ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿</h2><h3 id="ğŸ’°-æˆæœ¬ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#ğŸ’°-æˆæœ¬ä¼˜åŒ–" aria-hidden="true">#</a> ğŸ’° æˆæœ¬ä¼˜åŒ–</h3><ul><li><strong>Claude API</strong>: ~$3-15/ç™¾ä¸‡ tokens</li><li><strong>æœ¬åœ°æ¨¡å‹</strong>: ä»…æ¶ˆè€—ç”µè´¹ (~0.1å…ƒ/å°æ—¶)</li><li><strong>é€‚ç”¨åœºæ™¯</strong>: é‡å¤æ€§ä»»åŠ¡ã€å¼€å‘æµ‹è¯•ã€æ‰¹é‡å¤„ç†</li></ul><h3 id="ğŸ”’-éšç§ä¿æŠ¤" tabindex="-1"><a class="header-anchor" href="#ğŸ”’-éšç§ä¿æŠ¤" aria-hidden="true">#</a> ğŸ”’ éšç§ä¿æŠ¤</h3><ul><li>æ•æ„Ÿä»£ç æ— éœ€ä¸Šä¼ äº‘ç«¯</li><li>ç§æœ‰æ•°æ®æœ¬åœ°å¤„ç†</li><li>ç¬¦åˆä¼ä¸šå®‰å…¨è¦æ±‚</li></ul><h3 id="âš¡-æ€§èƒ½è¡¨ç°" tabindex="-1"><a class="header-anchor" href="#âš¡-æ€§èƒ½è¡¨ç°" aria-hidden="true">#</a> âš¡ æ€§èƒ½è¡¨ç°</h3><ul><li>M2 èŠ¯ç‰‡åŸç”Ÿä¼˜åŒ–</li><li>GPU åŠ é€Ÿæ¨ç†</li><li>8B æ¨¡å‹å“åº”æ—¶é—´ ~2s</li><li>æ”¯æŒå¹¶å‘è¯·æ±‚å¤„ç†</li></ul><h2 id="ğŸ”„-æ™ºèƒ½è·¯ç”±ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#ğŸ”„-æ™ºèƒ½è·¯ç”±ç­–ç•¥" aria-hidden="true">#</a> ğŸ”„ æ™ºèƒ½è·¯ç”±ç­–ç•¥</h2><h3 id="ä»»åŠ¡åˆ†ç±»å†³ç­–æ ‘" tabindex="-1"><a class="header-anchor" href="#ä»»åŠ¡åˆ†ç±»å†³ç­–æ ‘" aria-hidden="true">#</a> ä»»åŠ¡åˆ†ç±»å†³ç­–æ ‘</h3><div class="language-mermaid line-numbers-mode" data-ext="mermaid"><pre class="language-mermaid"><code><span class="token keyword">flowchart</span> TD
    A<span class="token text string">[æ¥æ”¶ä»»åŠ¡]</span> <span class="token arrow operator">--&gt;</span> B<span class="token text string">{å¤æ‚åº¦è¯„ä¼°}</span>
    B <span class="token arrow operator">--&gt;</span><span class="token label property">|é«˜å¤æ‚åº¦|</span> C<span class="token text string">[ä½¿ç”¨ Claude API]</span>
    B <span class="token arrow operator">--&gt;</span><span class="token label property">|ä¸­ä½å¤æ‚åº¦|</span> D<span class="token text string">{ä»»åŠ¡ç±»å‹è¯†åˆ«}</span>

    D <span class="token arrow operator">--&gt;</span><span class="token label property">|ä»£ç ç›¸å…³|</span> E<span class="token text string">[DeepSeek Coder 6.7B]</span>
    D <span class="token arrow operator">--&gt;</span><span class="token label property">|ä¸­æ–‡å¤„ç†|</span> F<span class="token text string">[Qwen 2.5 7B]</span>
    D <span class="token arrow operator">--&gt;</span><span class="token label property">|é€šç”¨ä»»åŠ¡|</span> G<span class="token text string">[Llama 3.1 8B]</span>
    D <span class="token arrow operator">--&gt;</span><span class="token label property">|ç‰¹æ®Šéœ€æ±‚|</span> H<span class="token text string">[åŠ¨æ€æ¨¡å‹é€‰æ‹©]</span>

    C <span class="token arrow operator">--&gt;</span> I<span class="token text string">[é«˜è´¨é‡è¾“å‡º]</span>
    E <span class="token arrow operator">--&gt;</span> J<span class="token text string">[ä»£ç ä¸“ä¸šè¾“å‡º]</span>
    F <span class="token arrow operator">--&gt;</span> K<span class="token text string">[ä¸­æ–‡ä¼˜åŒ–è¾“å‡º]</span>
    G <span class="token arrow operator">--&gt;</span> L<span class="token text string">[é€šç”¨è´¨é‡è¾“å‡º]</span>
    H <span class="token arrow operator">--&gt;</span> M<span class="token text string">[å®šåˆ¶åŒ–è¾“å‡º]</span>

    <span class="token keyword">style</span> A <span class="token style"><span class="token property">fill</span><span class="token operator">:</span>#e3f2fd</span>
    <span class="token keyword">style</span> B <span class="token style"><span class="token property">fill</span><span class="token operator">:</span>#f3e5f5</span>
    <span class="token keyword">style</span> C <span class="token style"><span class="token property">fill</span><span class="token operator">:</span>#e8f5e8</span>
    <span class="token keyword">style</span> D <span class="token style"><span class="token property">fill</span><span class="token operator">:</span>#fff3e0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è·¯ç”±è§„åˆ™é…ç½®" tabindex="-1"><a class="header-anchor" href="#è·¯ç”±è§„åˆ™é…ç½®" aria-hidden="true">#</a> è·¯ç”±è§„åˆ™é…ç½®</h3><table><thead><tr><th>ä»»åŠ¡ç±»å‹</th><th>å¤æ‚åº¦</th><th>æ¨èæ¨¡å‹</th><th>ä½¿ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>ä»£ç å®¡æŸ¥</td><td>ä½-ä¸­</td><td>DeepSeek Coder</td><td>æœ¬åœ°ä»£ç å®‰å…¨æ£€æŸ¥</td></tr><tr><td>æ–‡æœ¬ç¿»è¯‘</td><td>ä½</td><td>Qwen 2.5</td><td>ä¸­è‹±æ–‡äº’è¯‘</td></tr><tr><td>æ–‡æ¡£æ‘˜è¦</td><td>ä½-ä¸­</td><td>Llama 3.1</td><td>æ‰¹é‡æ–‡æ¡£å¤„ç†</td></tr><tr><td>åˆ›æ„å†™ä½œ</td><td>é«˜</td><td>Claude API</td><td>é«˜è´¨é‡å†…å®¹åˆ›ä½œ</td></tr><tr><td>å¤æ‚æ¨ç†</td><td>é«˜</td><td>Claude API</td><td>é€»è¾‘åˆ†æã€ç­–ç•¥åˆ¶å®š</td></tr></tbody></table><h2 id="ğŸ› ï¸-æŠ€æœ¯å®ç°æ ˆ" tabindex="-1"><a class="header-anchor" href="#ğŸ› ï¸-æŠ€æœ¯å®ç°æ ˆ" aria-hidden="true">#</a> ğŸ› ï¸ æŠ€æœ¯å®ç°æ ˆ</h2><h3 id="æ ¸å¿ƒç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#æ ¸å¿ƒç»„ä»¶" aria-hidden="true">#</a> æ ¸å¿ƒç»„ä»¶</h3><ul><li><strong>Ollama</strong>: æœ¬åœ°æ¨¡å‹è¿è¡Œæ—¶</li><li><strong>FastAPI</strong>: é«˜æ€§èƒ½ API ä»£ç†æœåŠ¡</li><li><strong>httpx</strong>: å¼‚æ­¥ HTTP å®¢æˆ·ç«¯</li><li><strong>Claude Tools</strong>: å·¥å…·è°ƒç”¨æ¡†æ¶</li></ul><h3 id="æ¨¡å‹é€‰æ‹©ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#æ¨¡å‹é€‰æ‹©ç­–ç•¥" aria-hidden="true">#</a> æ¨¡å‹é€‰æ‹©ç­–ç•¥</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>MODEL_RECOMMENDATIONS <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;mac_m2_8gb&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;llama3.1:8b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;qwen2.5:7b&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&quot;mac_m2_16gb&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;llama3.1:8b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;qwen2.5:14b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;deepseek-coder:6.7b&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&quot;mac_m2_24gb&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;llama3.1:70b-q4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;qwen2.5:32b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;deepseek-coder:33b&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ“Š-æ€§èƒ½åŸºå‡†æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#ğŸ“Š-æ€§èƒ½åŸºå‡†æµ‹è¯•" aria-hidden="true">#</a> ğŸ“Š æ€§èƒ½åŸºå‡†æµ‹è¯•</h2><h3 id="å“åº”æ—¶é—´å¯¹æ¯”" tabindex="-1"><a class="header-anchor" href="#å“åº”æ—¶é—´å¯¹æ¯”" aria-hidden="true">#</a> å“åº”æ—¶é—´å¯¹æ¯”</h3><table><thead><tr><th>ä»»åŠ¡ç±»å‹</th><th>æœ¬åœ°æ¨¡å‹ (8B)</th><th>Claude API</th><th>æˆæœ¬å¯¹æ¯”</th></tr></thead><tbody><tr><td>ç®€å•é—®ç­”</td><td>2-3s</td><td>1-2s</td><td>100:1</td></tr><tr><td>ä»£ç è§£é‡Š</td><td>3-5s</td><td>2-3s</td><td>50:1</td></tr><tr><td>æ–‡æ¡£ç¿»è¯‘</td><td>1-2s</td><td>1-2s</td><td>200:1</td></tr><tr><td>æ–‡æœ¬æ‘˜è¦</td><td>2-4s</td><td>1-3s</td><td>150:1</td></tr></tbody></table><h3 id="èµ„æºæ¶ˆè€—ç›‘æ§" tabindex="-1"><a class="header-anchor" href="#èµ„æºæ¶ˆè€—ç›‘æ§" aria-hidden="true">#</a> èµ„æºæ¶ˆè€—ç›‘æ§</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># å†…å­˜ä½¿ç”¨ç›‘æ§</span>
ollama <span class="token function">ps</span>

<span class="token comment"># GPU ä½¿ç”¨ç‡æŸ¥çœ‹</span>
<span class="token function">sudo</span> powermetrics <span class="token parameter variable">-n</span> <span class="token number">1</span> <span class="token parameter variable">--samplers</span> gpu_power

<span class="token comment"># æ¨¡å‹åˆ‡æ¢å»¶è¿Ÿ</span>
<span class="token function">time</span> ollama run llama3.1:8b <span class="token string">&quot;æµ‹è¯•å“åº”&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ”§-éƒ¨ç½²æ¶æ„è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#ğŸ”§-éƒ¨ç½²æ¶æ„è¯¦è§£" aria-hidden="true">#</a> ğŸ”§ éƒ¨ç½²æ¶æ„è¯¦è§£</h2><h3 id="_1-åŸºç¡€ç¯å¢ƒå‡†å¤‡" tabindex="-1"><a class="header-anchor" href="#_1-åŸºç¡€ç¯å¢ƒå‡†å¤‡" aria-hidden="true">#</a> 1. åŸºç¡€ç¯å¢ƒå‡†å¤‡</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># ç³»ç»Ÿè¦æ±‚æ£€æŸ¥</span>
system_profiler SPHardwareDataType <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;Apple M&quot;</span>
vm_stat <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;free&quot;</span>

<span class="token comment"># ä¼˜åŒ–è®¾ç½®</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">OLLAMA_GPU_LAYERS</span><span class="token operator">=</span><span class="token number">99</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">OLLAMA_NUM_PARALLEL</span><span class="token operator">=</span><span class="token number">2</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">OLLAMA_MAX_LOADED_MODELS</span><span class="token operator">=</span><span class="token number">3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-æœåŠ¡ç¼–æ’" tabindex="-1"><a class="header-anchor" href="#_2-æœåŠ¡ç¼–æ’" aria-hidden="true">#</a> 2. æœåŠ¡ç¼–æ’</h3><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment"># docker-compose.yml (å¯é€‰)</span>
<span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&#39;3.8&#39;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">local-llm-proxy</span><span class="token punctuation">:</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span> .
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;8000:8000&quot;</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> OLLAMA_HOST=http<span class="token punctuation">:</span>//host.docker.internal<span class="token punctuation">:</span><span class="token number">11434</span>
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ollama

  <span class="token key atrule">ollama</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> ollama/ollama
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;11434:11434&quot;</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ollama_data<span class="token punctuation">:</span>/root/.ollama

<span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token key atrule">ollama_data</span><span class="token punctuation">:</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸš€-å¿«é€Ÿå¼€å§‹" tabindex="-1"><a class="header-anchor" href="#ğŸš€-å¿«é€Ÿå¼€å§‹" aria-hidden="true">#</a> ğŸš€ å¿«é€Ÿå¼€å§‹</h2><h3 id="ä¸€é”®éƒ¨ç½²è„šæœ¬" tabindex="-1"><a class="header-anchor" href="#ä¸€é”®éƒ¨ç½²è„šæœ¬" aria-hidden="true">#</a> ä¸€é”®éƒ¨ç½²è„šæœ¬</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment"># setup-local-llm.sh</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;ğŸš€ å¼€å§‹éƒ¨ç½²æœ¬åœ°å¤§æ¨¡å‹ç³»ç»Ÿ...&quot;</span>

<span class="token comment"># 1. å®‰è£… Ollama</span>
<span class="token keyword">if</span> <span class="token operator">!</span> <span class="token builtin class-name">command</span> <span class="token parameter variable">-v</span> ollama <span class="token operator">&amp;&gt;</span> /dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;ğŸ“¦ æ­£åœ¨å®‰è£… Ollama...&quot;</span>
    <span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> https://ollama.com/install.sh <span class="token operator">|</span> <span class="token function">sh</span>
<span class="token keyword">fi</span>

<span class="token comment"># 2. ä¸‹è½½æ¨èæ¨¡å‹</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;ğŸ“¥ æ­£åœ¨ä¸‹è½½æ¨¡å‹...&quot;</span>
ollama pull llama3.1:8b
ollama pull qwen2.5:7b
ollama pull deepseek-coder:6.7b

<span class="token comment"># 3. å®‰è£… Python ä¾èµ–</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;ğŸ æ­£åœ¨å®‰è£… Python ä¾èµ–...&quot;</span>
pip <span class="token function">install</span> fastapi uvicorn httpx pydantic

<span class="token comment"># 4. å¯åŠ¨æœåŠ¡</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;ğŸ”¥ æ­£åœ¨å¯åŠ¨æœåŠ¡...&quot;</span>
python local-llm-proxy.py <span class="token operator">&amp;</span>

<span class="token comment"># 5. å¥åº·æ£€æŸ¥</span>
<span class="token function">sleep</span> <span class="token number">5</span>
<span class="token keyword">if</span> <span class="token function">curl</span> <span class="token parameter variable">-s</span> http://localhost:8000/health <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-q</span> <span class="token string">&quot;ok&quot;</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;âœ… ç³»ç»Ÿéƒ¨ç½²æˆåŠŸï¼&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;ğŸŒ ä»£ç†æœåŠ¡: http://localhost:8000&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;ğŸ¤– Ollama æœåŠ¡: http://localhost:11434&quot;</span>
<span class="token keyword">else</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;âŒ æœåŠ¡å¯åŠ¨å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ—¥å¿—&quot;</span>
<span class="token keyword">fi</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ”-ä½¿ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ğŸ”-ä½¿ç”¨ç¤ºä¾‹" aria-hidden="true">#</a> ğŸ” ä½¿ç”¨ç¤ºä¾‹</h2><h3 id="åœºæ™¯1-éšç§ä»£ç å®¡æŸ¥" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯1-éšç§ä»£ç å®¡æŸ¥" aria-hidden="true">#</a> åœºæ™¯1: éšç§ä»£ç å®¡æŸ¥</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># ç§æœ‰ä»£ç æœ¬åœ°å®¡æŸ¥</span>
<span class="token keyword">import</span> httpx

<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">review_private_code</span><span class="token punctuation">(</span>code_content<span class="token punctuation">)</span><span class="token punctuation">:</span>
    response <span class="token operator">=</span> <span class="token keyword">await</span> httpx<span class="token punctuation">.</span>post<span class="token punctuation">(</span>
        <span class="token string">&quot;http://localhost:8000/api/generate&quot;</span><span class="token punctuation">,</span>
        json<span class="token operator">=</span><span class="token punctuation">{</span>
            <span class="token string">&quot;prompt&quot;</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f&quot;è¯·å®¡æŸ¥ä»¥ä¸‹ä»£ç çš„å®‰å…¨æ¼æ´ï¼š\\n</span><span class="token interpolation"><span class="token punctuation">{</span>code_content<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">,</span>
            <span class="token string">&quot;model&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;deepseek-coder:6.7b&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;temperature&quot;</span><span class="token punctuation">:</span> <span class="token number">0.3</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;response&quot;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åœºæ™¯2-æ‰¹é‡æ–‡æ¡£å¤„ç†" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯2-æ‰¹é‡æ–‡æ¡£å¤„ç†" aria-hidden="true">#</a> åœºæ™¯2: æ‰¹é‡æ–‡æ¡£å¤„ç†</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># æ‰¹é‡ç¿»è¯‘æ–‡æ¡£</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">file</span> <span class="token keyword">in</span> docs/*.md<span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;å¤„ç†æ–‡ä»¶: <span class="token variable">$file</span>&quot;</span>
    <span class="token function">curl</span> <span class="token parameter variable">-X</span> POST http://localhost:8000/api/generate <span class="token punctuation">\\</span>
        <span class="token parameter variable">-H</span> <span class="token string">&quot;Content-Type: application/json&quot;</span> <span class="token punctuation">\\</span>
        <span class="token parameter variable">-d</span> <span class="token string">&quot;{
            <span class="token entity" title="\\&quot;">\\&quot;</span>prompt<span class="token entity" title="\\&quot;">\\&quot;</span>: <span class="token entity" title="\\&quot;">\\&quot;</span>å°†ä»¥ä¸‹å†…å®¹ç¿»è¯‘æˆè‹±æ–‡ï¼š<span class="token entity" title="\\\\">\\\\</span>n<span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> $file<span class="token variable">)</span></span><span class="token entity" title="\\&quot;">\\&quot;</span>,
            <span class="token entity" title="\\&quot;">\\&quot;</span>model<span class="token entity" title="\\&quot;">\\&quot;</span>: <span class="token entity" title="\\&quot;">\\&quot;</span>qwen2.5:7b<span class="token entity" title="\\&quot;">\\&quot;</span>
        }&quot;</span>
<span class="token keyword">done</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åœºæ™¯3-å¼€å‘åŠ©æ‰‹é›†æˆ" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯3-å¼€å‘åŠ©æ‰‹é›†æˆ" aria-hidden="true">#</a> åœºæ™¯3: å¼€å‘åŠ©æ‰‹é›†æˆ</h3><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// Claude Tools é›†æˆç¤ºä¾‹</span>
<span class="token keyword">class</span> <span class="token class-name">LocalLLMTool</span> <span class="token punctuation">{</span>
    <span class="token keyword">async</span> <span class="token function">call</span><span class="token punctuation">(</span>prompt<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> defaultOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
            model<span class="token operator">:</span> <span class="token string">&quot;llama3.1:8b&quot;</span><span class="token punctuation">,</span>
            temperature<span class="token operator">:</span> <span class="token number">0.7</span><span class="token punctuation">,</span>
            maxTokens<span class="token operator">:</span> <span class="token number">2000</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>defaultOptions<span class="token punctuation">,</span> <span class="token operator">...</span>options <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;http://localhost:8000/api/generate&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            method<span class="token operator">:</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">,</span>
            headers<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&#39;Content-Type&#39;</span><span class="token operator">:</span> <span class="token string">&#39;application/json&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            body<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                prompt<span class="token punctuation">,</span>
                <span class="token operator">...</span>config
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="token keyword">const</span> llm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LocalLLMTool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">llm</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">&quot;è§£é‡ŠReact Hooksçš„å·¥ä½œåŸç†&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    model<span class="token operator">:</span> <span class="token string">&quot;deepseek-coder:6.7b&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ›ï¸-é«˜çº§é…ç½®" tabindex="-1"><a class="header-anchor" href="#ğŸ›ï¸-é«˜çº§é…ç½®" aria-hidden="true">#</a> ğŸ›ï¸ é«˜çº§é…ç½®</h2><h3 id="æ¨¡å‹å‚æ•°ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#æ¨¡å‹å‚æ•°ä¼˜åŒ–" aria-hidden="true">#</a> æ¨¡å‹å‚æ•°ä¼˜åŒ–</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># é’ˆå¯¹ä¸åŒä»»åŠ¡çš„å‚æ•°è°ƒä¼˜</span>
TASK_CONFIGS <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;code_generation&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;temperature&quot;</span><span class="token punctuation">:</span> <span class="token number">0.1</span><span class="token punctuation">,</span>
        <span class="token string">&quot;top_p&quot;</span><span class="token punctuation">:</span> <span class="token number">0.9</span><span class="token punctuation">,</span>
        <span class="token string">&quot;repeat_penalty&quot;</span><span class="token punctuation">:</span> <span class="token number">1.1</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;creative_writing&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;temperature&quot;</span><span class="token punctuation">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span>
        <span class="token string">&quot;top_p&quot;</span><span class="token punctuation">:</span> <span class="token number">0.95</span><span class="token punctuation">,</span>
        <span class="token string">&quot;repeat_penalty&quot;</span><span class="token punctuation">:</span> <span class="token number">1.0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;translation&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;temperature&quot;</span><span class="token punctuation">:</span> <span class="token number">0.3</span><span class="token punctuation">,</span>
        <span class="token string">&quot;top_p&quot;</span><span class="token punctuation">:</span> <span class="token number">0.9</span><span class="token punctuation">,</span>
        <span class="token string">&quot;repeat_penalty&quot;</span><span class="token punctuation">:</span> <span class="token number">1.05</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç¼“å­˜ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#ç¼“å­˜ç­–ç•¥" aria-hidden="true">#</a> ç¼“å­˜ç­–ç•¥</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> functools <span class="token keyword">import</span> lru_cache
<span class="token keyword">import</span> hashlib

<span class="token decorator annotation punctuation">@lru_cache</span><span class="token punctuation">(</span>maxsize<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">cached_llm_call</span><span class="token punctuation">(</span>prompt_hash<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> model<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># ç¼“å­˜ç›¸åŒè¯·æ±‚çš„ç»“æœ</span>
    <span class="token keyword">return</span> call_ollama<span class="token punctuation">(</span>prompt<span class="token punctuation">,</span> model<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">get_prompt_hash</span><span class="token punctuation">(</span>prompt<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>prompt<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ“ˆ-ç›‘æ§å’Œè°ƒä¼˜" tabindex="-1"><a class="header-anchor" href="#ğŸ“ˆ-ç›‘æ§å’Œè°ƒä¼˜" aria-hidden="true">#</a> ğŸ“ˆ ç›‘æ§å’Œè°ƒä¼˜</h2><h3 id="æ€§èƒ½ç›‘æ§é¢æ¿" tabindex="-1"><a class="header-anchor" href="#æ€§èƒ½ç›‘æ§é¢æ¿" aria-hidden="true">#</a> æ€§èƒ½ç›‘æ§é¢æ¿</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># monitoring.py</span>
<span class="token keyword">import</span> psutil
<span class="token keyword">import</span> time

<span class="token keyword">def</span> <span class="token function">monitor_system_resources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;ç›‘æ§ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ&quot;&quot;&quot;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;cpu_percent&quot;</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>cpu_percent<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;memory_percent&quot;</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>virtual_memory<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>percent<span class="token punctuation">,</span>
        <span class="token string">&quot;gpu_temp&quot;</span><span class="token punctuation">:</span> get_gpu_temperature<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># éœ€è¦é¢å¤–å®ç°</span>
        <span class="token string">&quot;model_load_time&quot;</span><span class="token punctuation">:</span> measure_model_load_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">get_model_performance_metrics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;è·å–æ¨¡å‹æ€§èƒ½æŒ‡æ ‡&quot;&quot;&quot;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;tokens_per_second&quot;</span><span class="token punctuation">:</span> calculate_tokens_per_second<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;average_response_time&quot;</span><span class="token punctuation">:</span> get_average_response_time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;error_rate&quot;</span><span class="token punctuation">:</span> calculate_error_rate<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è‡ªåŠ¨è°ƒä¼˜å»ºè®®" tabindex="-1"><a class="header-anchor" href="#è‡ªåŠ¨è°ƒä¼˜å»ºè®®" aria-hidden="true">#</a> è‡ªåŠ¨è°ƒä¼˜å»ºè®®</h3><ul><li><strong>å†…å­˜ä¸è¶³</strong>: ä½¿ç”¨é‡åŒ–ç‰ˆæœ¬ (Q4/Q5)</li><li><strong>å“åº”æ…¢</strong>: å‡å°‘å¹¶å‘æ•°æˆ–åˆ‡æ¢æ›´å°æ¨¡å‹</li><li><strong>å‡†ç¡®æ€§å·®</strong>: æé«˜ temperature æˆ–åˆ‡æ¢æ›´å¤§æ¨¡å‹</li></ul><h2 id="ğŸ”®-æœªæ¥æ‰©å±•æ–¹å‘" tabindex="-1"><a class="header-anchor" href="#ğŸ”®-æœªæ¥æ‰©å±•æ–¹å‘" aria-hidden="true">#</a> ğŸ”® æœªæ¥æ‰©å±•æ–¹å‘</h2><h3 id="_1-å¤šæ¨¡æ€é›†æˆ" tabindex="-1"><a class="header-anchor" href="#_1-å¤šæ¨¡æ€é›†æˆ" aria-hidden="true">#</a> 1. å¤šæ¨¡æ€é›†æˆ</h3><ul><li>å›¾åƒç†è§£ï¼šLLaVAã€Qwen-VL</li><li>è¯­éŸ³å¤„ç†ï¼šWhisper æœ¬åœ°éƒ¨ç½²</li><li>è§†é¢‘åˆ†æï¼šVideo-ChatGPT</li></ul><h3 id="_2-é›†ç¾¤åŒ–éƒ¨ç½²" tabindex="-1"><a class="header-anchor" href="#_2-é›†ç¾¤åŒ–éƒ¨ç½²" aria-hidden="true">#</a> 2. é›†ç¾¤åŒ–éƒ¨ç½²</h3><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment"># kubernetes é›†ç¾¤é…ç½®ç¤ºä¾‹</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> local<span class="token punctuation">-</span>llm<span class="token punctuation">-</span>cluster
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">3</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> local<span class="token punctuation">-</span>llm
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> local<span class="token punctuation">-</span>llm
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> ollama
        <span class="token key atrule">image</span><span class="token punctuation">:</span> ollama/ollama<span class="token punctuation">:</span>latest
        <span class="token key atrule">resources</span><span class="token punctuation">:</span>
          <span class="token key atrule">limits</span><span class="token punctuation">:</span>
            <span class="token key atrule">nvidia.com/gpu</span><span class="token punctuation">:</span> <span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-æ™ºèƒ½è´Ÿè½½å‡è¡¡" tabindex="-1"><a class="header-anchor" href="#_3-æ™ºèƒ½è´Ÿè½½å‡è¡¡" aria-hidden="true">#</a> 3. æ™ºèƒ½è´Ÿè½½å‡è¡¡</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">LoadBalancer</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>nodes <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span><span class="token string">&quot;host&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;localhost:11434&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;load&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;models&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;llama3.1:8b&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token string">&quot;host&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;192.168.1.100:11434&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;load&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;models&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;qwen2.5:7b&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
        <span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">get_best_node</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> model_required<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        available_nodes <span class="token operator">=</span> <span class="token punctuation">[</span>n <span class="token keyword">for</span> n <span class="token keyword">in</span> self<span class="token punctuation">.</span>nodes <span class="token keyword">if</span> model_required <span class="token keyword">in</span> n<span class="token punctuation">[</span><span class="token string">&quot;models&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
        <span class="token keyword">return</span> <span class="token builtin">min</span><span class="token punctuation">(</span>available_nodes<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">&quot;load&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ“‹-æ•…éšœæ’æŸ¥æŒ‡å—" tabindex="-1"><a class="header-anchor" href="#ğŸ“‹-æ•…éšœæ’æŸ¥æŒ‡å—" aria-hidden="true">#</a> ğŸ“‹ æ•…éšœæ’æŸ¥æŒ‡å—</h2><h3 id="å¸¸è§é—®é¢˜è§£å†³" tabindex="-1"><a class="header-anchor" href="#å¸¸è§é—®é¢˜è§£å†³" aria-hidden="true">#</a> å¸¸è§é—®é¢˜è§£å†³</h3><table><thead><tr><th>é—®é¢˜</th><th>ç—‡çŠ¶</th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>Ollama å¯åŠ¨å¤±è´¥</td><td>ç«¯å£è¢«å ç”¨</td><td><code>lsof -i :11434</code> æŸ¥æ‰¾å¹¶ç»ˆæ­¢è¿›ç¨‹</td></tr><tr><td>æ¨¡å‹ä¸‹è½½ç¼“æ…¢</td><td>ç½‘ç»œé—®é¢˜</td><td>ä½¿ç”¨ä»£ç†æˆ–é•œåƒæº</td></tr><tr><td>å†…å­˜ä¸è¶³</td><td>ç³»ç»Ÿå¡é¡¿</td><td>ä½¿ç”¨é‡åŒ–æ¨¡å‹æˆ–å‡å°‘å¹¶å‘</td></tr><tr><td>GPU æœªä½¿ç”¨</td><td>CPU å ç”¨é«˜</td><td>è®¾ç½® <code>OLLAMA_GPU_LAYERS=99</code></td></tr></tbody></table><h3 id="æ—¥å¿—åˆ†æ" tabindex="-1"><a class="header-anchor" href="#æ—¥å¿—åˆ†æ" aria-hidden="true">#</a> æ—¥å¿—åˆ†æ</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># Ollama æ—¥å¿—</span>
<span class="token function">tail</span> <span class="token parameter variable">-f</span> ~/.ollama/logs/server.log

<span class="token comment"># ä»£ç†æœåŠ¡æ—¥å¿—</span>
python local-llm-proxy.py <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">|</span> <span class="token function">tee</span> logs/proxy.log

<span class="token comment"># ç³»ç»Ÿèµ„æºç›‘æ§</span>
<span class="token function">watch</span> <span class="token parameter variable">-n</span> <span class="token number">1</span> <span class="token string">&#39;ps aux | grep ollama; free -h&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ“š-å‚è€ƒæ–‡æ¡£" tabindex="-1"><a class="header-anchor" href="#ğŸ“š-å‚è€ƒæ–‡æ¡£" aria-hidden="true">#</a> ğŸ“š å‚è€ƒæ–‡æ¡£</h2>`,66),u={href:"https://ollama.com/docs",target:"_blank",rel:"noopener noreferrer"},d={href:"https://fastapi.tiangolo.com/",target:"_blank",rel:"noopener noreferrer"},k={href:"/claude-tools/overview",target:"_blank",rel:"noopener noreferrer"},v={href:"/optimization/m2-performance",target:"_blank",rel:"noopener noreferrer"},m=n("hr",null,null,-1),b=n("p",null,[n("em",null,"æœ¬æ¶æ„è®¾è®¡å……åˆ†åˆ©ç”¨äº† Mac M2 èŠ¯ç‰‡çš„ç¡¬ä»¶ä¼˜åŠ¿ï¼Œç»“åˆäº‘ç«¯å’Œæœ¬åœ°AIçš„æœ€ä½³å®è·µï¼Œä¸ºå¼€å‘è€…æä¾›äº†ä¸€ä¸ªæ—¢ç»æµåˆé«˜æ•ˆçš„AIå·¥å…·é“¾è§£å†³æ–¹æ¡ˆã€‚")],-1);function h(g,y){const s=p("ExternalLinkIcon");return l(),o("div",null,[r,n("ul",null,[n("li",null,[n("a",u,[a("Ollama å®˜æ–¹æ–‡æ¡£"),e(s)])]),n("li",null,[n("a",d,[a("FastAPI æ–‡æ¡£"),e(s)])]),n("li",null,[n("a",k,[a("Claude Tools æŒ‡å—"),e(s)])]),n("li",null,[n("a",v,[a("Mac M2 ä¼˜åŒ–æŒ‡å—"),e(s)])])]),m,b])}const f=t(c,[["render",h],["__file","LOCAL_LLM_ARCHITECTURE.html.vue"]]);export{f as default};
